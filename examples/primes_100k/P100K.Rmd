---
title: "Primes-100K. pt-SNE vs. FIt-SNE vs. UMAP"
author: |-
  J.Garriga; F.Bartumeus\
  ICREA Movement Ecology Laboratory (CEAB-CSIC)\
  jgarriga@ceab.csic.es
date: "bigMap_4.5.0, `r format(Sys.Date(), '%b %Y')`"
output: html_document
---

```{r, echo = FALSE}
library(knitr)
library(kableExtra)
```
```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, }
library(bigMap)
```

### Load data

```{r, }
load('./P100K.RData')
```

### Load results

```{r, }
load('./umap.RData')
load('./fitsne.RData')
load('./ptsne.RData')
ls()
```

### Output

#### UMAP

```{r, echo = FALSE, out.width = '25%', fig.show = 'hold'}
knitr::include_graphics(c('./P100K_50_umap.png', './P100K_100_umap.png', './P100K_500_umap.png', './P100K_1000_umap.png'))
```

#### FIt-SNE

```{r, echo = FALSE, out.width = '25%', fig.show = 'hold'}
knitr::include_graphics(c('./P100K_50_fitsne.png', './P100K_100_fitsne.png', './P100K_500_fitsne.png', './P100K_1000_fitsne.png'))
```

#### pt-SNE

```{r, echo = FALSE, out.width = '25%', fig.show = 'hold'}
knitr::include_graphics(c('./P100K_50_ptsne.png', './P100K_500_ptsne.png', './P100K_5000_ptsne.png', './P100K_10000_ptsne.png'))
```

### hl-Correlation

#### pt-SNE

```{r, }
hlTable <- t(sapply(ptsne.list, function(m) summary(m$hlC)))
rownames(hlTable) <- sapply(ptsne.list, function(m) m$ppx$ppx)
knitr::kable(hlTable, caption = 'hl-Correlation') %>%
  kable_styling(full_width = F)
```

### K-ary neighborhood preservation

```{r, out.width = '33%', fig.show = 'hold'}
bdm.knp.plot(umap.list, ppxfrmt = 0)
bdm.knp.plot(fitsne.list, ppxfrmt = 0)
bdm.knp.plot(ptsne.list, ppxfrmt = 0)
```

### Running Times

```{r, }
rTimes <- t(sapply(ptsne.list, function(m) (m$ppx$t[3] +m$t$ptsne[3])))
rTimes <- round(rTimes /60, 2)
knitr::kable(rTimes, caption = 'Computation times (min)') %>%
  kable_styling(full_width = F)
```

*Run on: Intel(R) Xeon(R) CPU E5-2650 v3 2.30GHz, 32Mb cache, 41 cores, 4GB/core RAM.*
